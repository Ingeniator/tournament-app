{
  "rules": {
    "tournaments": {
      "$tournamentId": {
        ".read": true,
        ".write": "auth != null && (!data.exists() || data.child('organizerId').val() === auth.uid)",
        "players": {
          "$playerId": {
            ".write": "auth != null && $playerId === auth.uid",
            ".validate": "newData.hasChildren(['name', 'timestamp']) && newData.child('name').isString() && newData.child('name').val().length < 30 && (!newData.hasChild('confirmed') || newData.child('confirmed').isBoolean())"
          }
        }
      }
    },
    "codes": {
      "$code": {
        ".read": true,
        ".write": "auth != null && (!data.exists() || !newData.exists() && root.child('tournaments').child(data.val()).child('organizerId').val() === auth.uid)"
      }
    },
    "supporters": {
      ".read": true,
      "$id": {
        ".write": "auth != null && !data.exists()",
        ".validate": "newData.hasChildren(['name', 'amount', 'timestamp']) && newData.child('name').isString() && newData.child('name').val().length >= 1 && newData.child('name').val().length <= 50 && newData.child('amount').isNumber() && (newData.child('amount').val() === 0 || newData.child('amount').val() === 3 || newData.child('amount').val() === 5 || newData.child('amount').val() === 10) && newData.child('timestamp').isNumber() && (!newData.hasChild('message') || newData.child('message').isString() && newData.child('message').val().length <= 50)"
      }
    },
    "users": {
      "$uid": {
        ".read": "auth != null && auth.uid === $uid",
        "name": {
          ".read": "auth != null",
          ".write": "auth != null && auth.uid === $uid",
          ".validate": "newData.isString() && newData.val().length >= 1 && newData.val().length <= 50"
        },
        "organized": {
          "$tournamentId": {
            ".write": "auth != null && auth.uid === $uid",
            ".validate": "newData.isBoolean() || !newData.exists()"
          }
        },
        "registrations": {
          "$tournamentId": {
            ".write": "auth != null && auth.uid === $uid",
            ".validate": "newData.isBoolean() || !newData.exists()"
          }
        }
      }
    }
  }
}
